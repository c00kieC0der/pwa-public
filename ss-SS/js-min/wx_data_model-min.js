var _Data={},app={};!function(){var a,t,e,n=document.createEvent("Event");n.initEvent("builder",!0,!0);var r=document.createEvent("Event");r.initEvent("astro-builder",!0,!0);var i=document.createEvent("Event");i.initEvent("almanac-builder",!0,!0),_Data.collectNew=function(){_User.activeLocation.lat=Number(_User.activeLocation.lat).toPrecision(4).toString(),_User.activeLocation["long"]=Number(_User.activeLocation["long"]).toPrecision(4).toString(),a="https://api.weather.com/v2/turbo/vt1fifteenminute;vt1hourlyForecast;vt1precipitation;vt1currentdatetime;vt1dailyForecast;vt1observation?units="+_User.unitPref+"&language="+_User.lang+"&geocode="+_User.activeLocation.lat+","+_User.activeLocation["long"]+"&format=json&apiKey=c1ea9f47f6a88b9acb43aba7faf389d4",t="https://dsx.weather.com/wxd/v2/Astro/"+_User.lang+"/0/3/("+helper.getActiveLocID()+")?api=7bb1c920-7027-4289-9c96-ae5e263980bc",e="https://dsx.weather.com/wxd/v2/FarmingAlmanac/"+_User.lang+"/0/"+_User.activeLocation.lat+","+_User.activeLocation["long"]+"?api=7bb1c920-7027-4289-9c96-ae5e263980bc",app.hasRequestPending=!0,AjaxRequest.get({url:a,generateUniqueUrl:!1,onSuccess:function(a){var t=JSON.parse(a.responseText);_Data.obs=t.vt1observation,_Data.datetime=t.vt1currentdatetime,_Data.dailyForecast=t.vt1dailyForecast,_Data.pollenforecast=t.vt1pollenforecast,_Data.precipitation=t.vt1precipitation,_Data.fifteen=t.vt1fifteenminute,_Data.hourly=t.vt1hourlyForecast,v(),_(),m(),document.getElementById("event-anchor").dispatchEvent(n),app.hasRequestPending=!1},onError:function(a){console.log(a)}}),AjaxRequest.get({url:t,generateUniqueUrl:!1,onSuccess:function(a){var t=JSON.parse(a.responseText);_Data.solarData=t[0].doc,f(),document.getElementById("event-anchor").dispatchEvent(r)},onError:function(a){console.log(a)}}),AjaxRequest.get({url:e,generateUniqueUrl:!1,onSuccess:function(a){var t=JSON.parse(a.responseText).FarmingAlmanacRecordData,e=t.OneDayHistorical,n=t.ReportedConditions,r=t.HistoricalMonthlyAvg,D=s(_User.unitPref);_Data.tempUnit=D.tempUnit,_Data.precipUnit=D.precipUnit,_Data.oneDayHistorical=d(e,_Data.tempUnit),_Data.reportedConditions=c(n,_Data.tempUnit,_Data.precipUnit),_Data.historicalMonthlyAvg=o(r,_Data.tempUnit,_Data.precipUnit),_Data.almanacMonths=h(),document.getElementById("event-anchor").dispatchEvent(i)},onError:function(a){console.log("error: ",a)}})};var o=function(a,t,e){var n={},r=["currentMonthAvgHigh","currentMonthAvgLow","currentMonthAvgPrecip","monthAfterNextAvgHigh","monthAfterNextAvgLow","monthAfterNextAvgPrecip","nextMonthAvgHigh","nextMonthAvgLow","nextMonthAvgPrecip"];return r.forEach(function(r){r.indexOf("Precip")>-1?n[r]=a[r+e]:n[r]=a[r+t]}),n},s=function(a){var t={};return t.tempUnit="e"===a?"F":"C",t.precipUnit="e"===a?"In":"Mm",t},d=function(a,t){var e={};return e.recordHighYear=a.yearOfRecordHighTemp,e.recordLowYear=a.yearOfRecordLowTemp,e.recordHigh=a["recordHigh"+t],e.recordLow=a["recordLow"+t],e.avgPrecip=helper.safeDisplay(),e.avgHigh=a["avgHigh"+t],e.avgLow=a["avgLow"+t],e},c=function(a,t,e){var n={},r=["mtdHigh","mtdLow","mtdPrecip","prevDayHigh","prevDayLow","prevDayPrecip","sevenDayHigh","sevenDayLow","sevenDayPrecip"];return r.forEach(function(r){n[r]=r.indexOf("Precip")>-1?a[r+e]:n[r]=a[r+t]}),n},D=function(a){return moment(a).format(_Lang["h:mm a"])},u=function(a){return moment(a).format(_Lang["ddd, MMM Do"])},y=function(a){var t=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],n=new Date(a);return{dayName:t[n.getDay()],date:e[n.getMonth()]+" "+n.getDate(),dayIndex:n.getDay()}},h=function(){var a=_Lang.MONTH,t=new Date;return{month1:a[t.getMonth()],month2:a[t.getMonth()+1],month3:a[t.getMonth()+2],currentDate:a[t.getMonth()]+" "+t.getDate()}},p=function(a){for(var t in a)a.hasOwnProperty(t)&&(_Data.dailyForecast[t+"Time"]=[],_Data.dailyForecast[t+"Date"]=[],a[t].forEach(function(e,n){_Data.dailyForecast[t+"Time"][n]=D(a[t][n]),_Data.dailyForecast[t+"Date"][n]=D(a[t][n])}))},m=function(){var a={sunrise:_Data.dailyForecast.sunrise,sunset:_Data.dailyForecast.sunset,moonrise:_Data.dailyForecast.moonrise,moonset:_Data.dailyForecast.moonset};p(a),_Data.tenDay=_Data.dailyForecast.day,_Data.hourly.time=[],_Data.hourly.date=[],_Data.lookingAhead=w(),_Data.obs.timestamp=l(),_Data.almanacMonths=g();for(var t in _Data.hourly.processTime)_Data.hourly.time[t]=D(_Data.hourly.processTime[t]),_Data.hourly.date[t]=u(_Data.hourly.processTime[t])},g=function(){var a=h(_Data.datetime.datetime);return a},l=function(){var a=D(_Data.obs.observationTime);return a},v=function(){_Data.dailyForecast.dayData=_Data.dailyForecast.day;var a=_Data.dailyForecast.night,t={dateDay:[],dateDayIndex:[],dateMonthDate:[],sunrise:[],sunset:[],moonrise:[],moonset:[],dayTemp:_Data.dailyForecast.day.temperature,nightPrecipPct:a.precipPct,nightTemp:a.temperature,nightUVIndex:a.uvIndex,nightIcon:a.icon,nightIconExtended:a.iconExtended,nightPhrase:a.phrase,nightNarrative:a.narrative,nightWindDirCompass:a.windDirCompass,nightWindSpeed:a.windSpeed,nightHumidityPct:a.humidityPct,dateNight:[]};for(var e in _Data.dailyForecast.validDate){var n=y(_Data.dailyForecast.validDate[e]);t.dateDay[e]="Today"===_Data.dailyForecast.day.dayPartName[e]?"Today":n.dayName,t.dateNight[e]="Today"===t.dateDay[e]?"Tonight":n.dayName+" Night",t.dateDayIndex[e]=n.dayIndex,t.dateMonthDate[e]=n.date,t.sunrise[e]=D(_Data.dailyForecast.sunrise[e]),t.sunset[e]=D(_Data.dailyForecast.sunset[e]),t.moonrise[e]=D(_Data.dailyForecast.moonrise[e]),t.moonset[e]=D(_Data.dailyForecast.moonset[e]),t.nightIcon[e]=t.nightIcon[e]}_Data.dailyForecast.dayData=t},_=function(){_Data.dailyForecast.currWeekendData=[],_Data.dailyForecast.nextWeekendData=[];var a=!1,t=0;for(var e in _Data.dailyForecast.dayData.dateDayIndex)if(_Data.dailyForecast.dayData.dateDayIndex.hasOwnProperty(e)&&(_Data.dailyForecast.dayData.dateDayIndex[e]>4||0===_Data.dailyForecast.dayData.dateDayIndex[e])){if(a)for(var n in _Data.dailyForecast.dayData)_Data.dailyForecast.nextWeekendData[n]||(_Data.dailyForecast.nextWeekendData[n]=[]),_Data.dailyForecast.nextWeekendData[n][t]=_Data.dailyForecast.dayData[n][e];else{for(var n in _Data.dailyForecast.dayData)_Data.dailyForecast.currWeekendData[n]||(_Data.dailyForecast.currWeekendData[n]=[]),_Data.dailyForecast.currWeekendData[n][t]=_Data.dailyForecast.dayData[n][e];t++}if(0==_Data.dailyForecast.dayData.dateDayIndex[e]){if(1==a)break;a=!0,t=0}}},w=function(){var a=_Data.dailyForecast,t=[];return t=null===a.day.dayPartName[0]?[{daypartName:a.night.dayPartName[0],highLow:"Low",phrase:a.night.phrase[0],wxicon:a.night.icon[0],temperature:a.night.temperature[0],narrative:a.night.narrative[0],precip:a.night.precipPct[0],windDirCompass:a.night.windDirCompass[0],windDirDegrees:a.night.windDirDegrees[0],windSpeed:a.night.windSpeed[0],humidity:a.night.humidityPct[0],uvIndex:a.night.uvIndex[0],sunrise:D(a.sunrise[0]),sunset:D(a.sunset[0])},{daypartName:a.day.dayPartName[1],highLow:"High",phrase:a.day.phrase[1],wxicon:a.day.icon[1],temperature:a.day.temperature[1],narrative:a.day.narrative[1],precip:a.day.precipPct[1],windDirCompass:a.day.windDirCompass[1],windDirDegrees:a.day.windDirDegrees[1],windSpeed:a.day.windSpeed[1],humidity:a.day.humidityPct[1],uvIndex:a.day.uvIndex[1],sunrise:D(a.sunrise[1]),sunset:D(a.sunset[1])},{daypartName:a.night.dayPartName[1],highLow:"Low",phrase:a.night.phrase[1],wxicon:a.night.icon[1],temperature:a.night.temperature[1],narrative:a.night.narrative[1],precip:a.night.precipPct[1],windDirCompass:a.night.windDirCompass[1],windDirDegrees:a.night.windDirDegrees[1],windSpeed:a.night.windSpeed[1],humidity:a.night.humidityPct[1],uvIndex:a.night.uvIndex[1],sunrise:D(a.sunrise[2]),sunset:D(a.sunset[2])}]:[{daypartName:a.day.dayPartName[0],highLow:"High",phrase:a.day.phrase[0],wxicon:a.day.icon[0],temperature:a.day.temperature[0],narrative:a.day.narrative[0],precip:a.day.precipPct[0],windDirCompass:a.day.windDirCompass[0],windDirDegrees:a.day.windDirDegrees[0],windSpeed:a.day.windSpeed[0],humidity:a.day.humidityPct[0],uvIndex:a.day.uvIndex[0],sunrise:D(a.sunrise[0]),sunset:D(a.sunset[0])},{daypartName:a.night.dayPartName[0],highLow:"Low",phrase:a.night.phrase[0],wxicon:a.night.icon[0],temperature:a.night.temperature[0],narrative:a.night.narrative[0],precip:a.night.precipPct[0],windDirCompass:a.night.windDirCompass[0],windDirDegrees:a.night.windDirDegrees[0],windSpeed:a.night.windSpeed[0],humidity:a.night.humidityPct[0],uvIndex:a.night.uvIndex[0],sunrise:D(a.sunrise[0]),sunset:D(a.sunset[0])},{daypartName:a.day.dayPartName[1],highLow:"High",phrase:a.day.phrase[1],wxicon:a.day.icon[1],temperature:a.day.temperature[1],narrative:a.day.narrative[1],precip:a.day.precipPct[1],windDirCompass:a.day.windDirCompass[1],windDirDegrees:a.day.windDirDegrees[1],windSpeed:a.day.windSpeed[1],humidity:a.day.humidityPct[1],uvIndex:a.day.uvIndex[1],sunrise:D(a.sunrise[1]),sunset:D(a.sunset[1])}]},f=function(){if(_Data&&_Data.solarData){_Data.solarData.noonTime=[],_Data.solarData.noonDate=[],_Data.solarData.moonIcons=[];var a=0;for(var t in _Data.solarData.AstroData)_Data.solarData.AstroData.hasOwnProperty(t)&&(_Data.solarData.noonTime[t]=D(_Data.solarData.AstroData[t].sun.zenith.local),_Data.solarData.noonDate[t]=u(_Data.solarData.AstroData[t].sun.zenith.local),_Data.solarData.moonIcons[a++]=_Data.solarData.AstroData[t].moon.riseSet.riseIcon,_Data.solarData.moonIcons[a++]=_Data.solarData.AstroData[t].moon.riseSet.setIcon)}}}();